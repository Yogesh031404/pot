# Netlify configuration for Eco-Pots Student Registration Web App

[build]
  # Build command (not needed for static site)
  command = "echo 'No build required for static site'"

  # Directory to publish
  publish = "."

  # Environment variables for build
  [build.environment]
    NODE_VERSION = "18"

# Redirects and rewrites
[[redirects]]
  # Handle 404 errors by redirecting to home page
  from = "/*"
  to = "/index.html"
  status = 404

[[redirects]]
  # Force HTTPS
  from = "http://ecopots.netlify.app/*"
  to = "https://ecopots.netlify.app/:splat"
  status = 301

# Headers for security and performance
[[headers]]
  # Apply security headers to all routes
  for = "/*"
  [headers.values]
    # Security headers
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1; mode=block"
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Permissions-Policy = "geolocation=(), microphone=(), camera=()"

    # Performance headers
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  # HTML files should not be cached aggressively
  for = "*.html"
  [headers.values]
    Cache-Control = "public, max-age=0, must-revalidate"

[[headers]]
  # CSS and JS files can be cached
  for = "/*.{css,js}"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  # Images should be cached
  for = "/images/*"
  [headers.values]
    Cache-Control = "public, max-age=2592000"

# Edge functions - not needed for Microsoft Forms integration

# Environment variables (these will be set in Netlify dashboard)
# GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec"
# SPREADSHEET_ID = "YOUR_SPREADSHEET_ID"
# WHATSAPP_GROUP_LINK = "https://chat.whatsapp.com/YOUR_GROUP_INVITE"
# CONTACT_EMAIL = "ecopots@yourdomain.com"
# RECAPTCHA_SITE_KEY = "YOUR_RECAPTCHA_SITE_KEY"

# Context-specific environment variables
[context.production.environment]
  CONTACT_EMAIL = "ecopots@yourdomain.com"
  DEBUG = "false"

[context.deploy-preview.environment]
  CONTACT_EMAIL = "test-ecopots@yourdomain.com"
  DEBUG = "true"

[context.branch-deploy.environment]
  CONTACT_EMAIL = "staging-ecopots@yourdomain.com"
  DEBUG = "true"

# Plugin configurations
# No plugins required - we use Microsoft Forms for form handling

[[plugins]]
  # Optional: Netlify plugin for sitemap generation
  package = "@netlify/plugin-sitemap"

  [plugins.inputs]
    buildDir = "dist"
    baseUrl = "https://ecopots.netlify.app"

# Functions directory (if using Netlify Functions)
[functions]
  directory = "netlify/functions"
  node_bundler = "esbuild"

# Branch deploy settings
[context.production]
  command = "echo 'Production deployment'"

[context.deploy-preview]
  command = "echo 'Deploy preview'"

[context.branch-deploy]
  command = "echo 'Branch deploy'"

# Specific settings for different environments
[dev]
  command = "echo 'Development server'"
  targetPort = 8080
  autoLaunch = true

# Processing settings
[processing]
  # Skip processing for certain file types
  skip_processing = false

  # CSS processing
  [processing.css]
    bundle = true
    minify = true

  # JS processing
  [processing.js]
    bundle = true
    minify = true

# Asset optimization
[build.processing]
  skip_processing = false
  [build.processing.css]
    bundle = true
    minify = true
  [build.processing.js]
    bundle = false
    minify = true
  [build.processing.html]
    pretty_urls = true
  [build.processing.images]
    compress = true